{% extends "base.html" %}
{% block content %}
<h2>Payment Management</h2>

{% if message %}
<div class="alert">{{ message }}</div>
{% endif %}

<h3>Add Payment</h3>
<form method="post" action="/admin/payments" class="form-card">
    <label>Booking</label>
    <select name="booking_id" required>
        <option value="">-- Select Booking --</option>
        {% for b in bookings %}
        <option value="{{ b.booking_id }}">
            #{{ b.booking_id }} - {{ b.customer_name }} ({{ b.service_name }})
        </option>
        {% endfor %}
    </select>
    <label>Amount</label>
    <input type="number" step="0.01" name="amount" required>
    <label>Payment Mode</label>
    <select name="payment_mode" required>
        <option value="CASH">Cash</option>
        <option value="CARD">Card</option>
        <option value="UPI">UPI</option>
        <option value="ONLINE">Online</option>
    </select>
    <label>Payment Status</label>
    <select name="payment_status" required>
        <option value="PENDING">Pending</option>
        <option value="PAID">Paid</option>
        <option value="FAILED">Failed</option>
    </select>
    <label>Transaction Ref (optional)</label>
    <input type="text" name="transaction_ref">
    <button type="submit">Save Payment</button>
</form>

<h3 style="margin-top:2rem;">Payments List</h3>
<table class="table">
    <tr>
        <th>ID</th><th>Booking</th><th>Customer</th><th>Service</th>
        <th>Amount</th><th>Mode</th><th>Status</th><th>Date</th><th>Ref</th>
    </tr>
    {% for p in payments %}
    <tr>
        <td>{{ p.payment_id }}</td>
        <td>#{{ p.booking_id }}</td>
        <td>{{ p.customer_name }}</td>
        <td>{{ p.service_name }}</td>
        <td>{{ p.amount }}</td>
        <td>{{ p.payment_mode }}</td>
        <td>{{ p.payment_status }}</td>
        <td>{{ p.payment_date }}</td>
        <td>{{ p.transaction_ref or '-' }}</td>
    </tr>
    {% else %}
    <tr><td colspan="9">No payments recorded yet.</td></tr>
    {% endfor %}
</table>
{% endblock %}
